<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>WebEx Meeting</title>
    <link rel="stylesheet" href="./webex_meeting.css">
    <!-- Webex SDK -->
    <script src="https://unpkg.com/@webex/sdk@latest/dist/webex.min.js"></script>
</head>
<body>
    <!-- Meeting Container -->
    <div class="meeting-container">
        <!-- Video Grid -->
        <div class="video-grid" id="videoGrid">
            <!-- Main Video Area -->
            <div class="main-video-container">
                <video id="localVideo" autoplay muted playsinline></video>
                <div class="video-overlay">
                    <span class="participant-name">You</span>
                    <div class="video-status">
                        <span class="status-indicator" id="localAudioStatus"></span>
                        <span class="status-indicator" id="localVideoStatus"></span>
                    </div>
                </div>
                <div class="screen-share-indicator" id="screenShareIndicator" style="display: none;">
                    <i class="icon-monitor"></i> Screen Sharing
                </div>
            </div>
            
            <!-- Remote Videos Container -->
            <div class="remote-videos" id="remoteVideos">
                <!-- Remote participant videos will be added here dynamically -->
            </div>
        </div>

        <!-- Control Bar -->
        <div class="control-bar">
            <div class="control-group">
                <!-- Microphone Control -->
                <button class="control-btn" id="audioBtn" title="Toggle Microphone">
                    <svg class="icon" id="audioIcon" viewBox="0 0 24 24">
                        <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
                        <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
                    </svg>
                    <span class="control-label">Mute</span>
                </button>

                <!-- Video Control -->
                <button class="control-btn" id="videoBtn" title="Toggle Video">
                    <svg class="icon" id="videoIcon" viewBox="0 0 24 24">
                        <path d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"/>
                    </svg>
                    <span class="control-label">Stop Video</span>
                </button>

                <!-- Screen Share Control -->
                <button class="control-btn" id="shareBtn" title="Share Screen">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M20 18c1.1 0 1.99-.9 1.99-2L22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2H0v2h24v-2h-4zM4 6h16v10H4V6z"/>
                        <path d="M12 10l-3 3h2v3h2v-3h2z"/>
                    </svg>
                    <span class="control-label">Share Screen</span>
                </button>

                <!-- Participants Control -->
                <button class="control-btn" id="participantsBtn" title="Show Participants">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/>
                    </svg>
                    <span class="control-label">Participants</span>
                    <span class="participant-count" id="participantCount">1</span>
                </button>

                <!-- Chat Control -->
                <button class="control-btn" id="chatBtn" title="Open Chat">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"/>
                    </svg>
                    <span class="control-label">Chat</span>
                </button>

                <!-- More Options -->
                <button class="control-btn" id="moreBtn" title="More Options">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>
                    </svg>
                    <span class="control-label">More</span>
                </button>

                <!-- Leave Meeting -->
                <button class="control-btn leave-btn" id="leaveBtn" title="Leave Meeting">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M16 13h-3V3h-2v10H8l4 4 4-4zM4 19h16v2H4z"/>
                    </svg>
                    <span class="control-label">Leave</span>
                </button>
            </div>

            <!-- Meeting Info -->
            <div class="meeting-info">
                <span class="meeting-id" id="meetingIdDisplay"></span>
                <span class="meeting-timer" id="meetingTimer">00:00</span>
                <span class="version-badge" id="versionDisplay" title="Build Version"></span>
            </div>
        </div>

        <!-- Participants Panel -->
        <div class="side-panel" id="participantsPanel">
            <div class="panel-header">
                <h3>Participants (<span id="participantCountHeader">1</span>)</h3>
                <button class="close-btn" id="closeParticipantsBtn">×</button>
            </div>
            <div class="panel-content">
                <div class="participant-list" id="participantList">
                    <!-- Participants will be listed here -->
                </div>
            </div>
        </div>

        <!-- Chat Panel -->
        <div class="side-panel" id="chatPanel">
            <div class="panel-header">
                <h3>Chat</h3>
                <button class="close-btn" id="closeChatBtn">×</button>
            </div>
            <div class="panel-content">
                <div class="chat-messages" id="chatMessages">
                    <!-- Chat messages will appear here -->
                </div>
                <div class="chat-input-container">
                    <input type="text" id="chatInput" placeholder="Type a message..." />
                    <button id="sendChatBtn">Send</button>
                </div>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div class="loading-overlay" id="loadingOverlay">
            <div class="spinner"></div>
            <p>Connecting to meeting...</p>
        </div>

        <!-- Error Modal -->
        <div class="modal" id="errorModal" style="display: none;">
            <div class="modal-content">
                <h3>Error</h3>
                <p id="errorMessage"></p>
                <button id="errorCloseBtn">Close</button>
            </div>
        </div>

        <!-- Permission Request Modal -->
        <div class="modal" id="permissionModal" style="display: none;">
            <div class="modal-content">
                <h3>Permissions Required</h3>
                <p>This meeting requires access to your camera and microphone. Please grant permissions to continue.</p>
                <button id="grantPermissionBtn">Grant Permissions</button>
            </div>
        </div>
    </div>

    <script src="./webex_meeting.js"></script>
</body>
</html>
